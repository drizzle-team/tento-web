---
interface Props {
  value: string;
  href: string;
  activeKeywords: string[];
}

const { value, href, activeKeywords } = Astro.props;
const { href: astroHref } = Astro.url;
const isActive = activeKeywords && activeKeywords.some(keyword => astroHref.includes(keyword));
---
<a
  href={href}
  data-active-keywords={activeKeywords}
  class:list={['nav_item', isActive && 'nav_item_active']}
>
  {value}
</a>

<style>
  html[class~=dark] .nav_item {
    outline-offset: 2px;
    outline: 2px solid transparent;
    transition-duration: .15s;
    transition-timing-function: cubic-bezier(.4,0,.2,1);
    word-break: break-word;
    color: rgb(115,115,115);
  }

  html[class~=dark] .nav_item:hover {
    color: rgb(249,250,251);
    background-color: hsl(204deg 100% 94%/.05);
  }

  html[class~=dark] .nav_item_active {
      color: hsl(204deg 100% 45%);
      background-color: hsl(204deg 100% 66%/.1);
  }

  .nav_item, .nav_item_active {
    height: 40px;
    outline: 2px solid transparent;
    display: flex;
    align-items: center;
    cursor: pointer;
    border-radius: 4px;
    padding-left: 8px;
    padding-right: 8px;
    color: rgba(107,114,128,var(--tw-text-opacity));
    transition: all cubic-bezier(.4,0,.2,1) .15s;
    }

  .nav_item:hover {
    background-color: rgb(243,244,246);
    color: rgb(17,24,39);
  }

  .nav_item_active {
    color: hsl(212deg 100% 32%);
    background-color: hsl(212deg 100% 94%);
    font-weight: 600;
  }
</style>

<script>
  const navItems = document.querySelectorAll('[data-active-keywords]');
  const handleUrlChange = () => {
    const currentUrl = window.location.href;
    navItems.forEach((item) => {
      if(item instanceof HTMLElement) {
        const activeKeywords = item.dataset.activeKeywords?.split(',');
        const isActive = activeKeywords && activeKeywords.some(keyword => currentUrl.includes(keyword));
        item.classList.toggle('item_wrap_active', isActive);
      }
    });
  }
  window.addEventListener('hashchange', handleUrlChange);
  document.addEventListener('DOMContentLoaded', handleUrlChange);
</script>